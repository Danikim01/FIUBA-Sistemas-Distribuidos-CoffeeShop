{
  "common_environment": {
    "RABBITMQ_HOST": "rabbitmq",
    "RABBITMQ_PORT": 5672,
    "prefetch_count": 20
  },
  "service_environment": {
    "gateway": {
      "OUTPUT_QUEUE": "transactions_raw",
      "RESULTS_QUEUE": "gateway_results",
      "STORES_EXCHANGE": "stores_raw",
      "USERS_QUEUE": "users_raw",
      "TRANSACTION_ITEMS_QUEUE": "transaction_items_raw",
      "MENU_ITEMS_QUEUE": "menu_items_raw",
      "CHUNK_SIZE": 5000
    },
    "client": {
      "count": 2,
      "GATEWAY_HOST": "gateway",
      "GATEWAY_PORT": "12345",
      "BATCH_MAX_SIZE_KB": "512",
      "LOG_LEVEL": "INFO",
      "DATA_DIR": ".data",
      "REDUCED": true,
      "SESSIONS": 2
    }
  },
  "workers": {
    "year_filter": {
      "count": 2,
      "environment": {
        "INPUT_QUEUE": "transactions_raw",
        "OUTPUT_EXCHANGE": "transactions_year_filtered"
      }
    },
    "items_year_filter": {
      "count": 2,
      "environment": {
        "INPUT_QUEUE": "transaction_items_raw",
        "OUTPUT_QUEUE": "transaction_items_year_filtered"
      }
    },
    "time_filter": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transactions_year_filtered",
        "INPUT_QUEUE": "transactions_year_filtered_time",
        "OUTPUT_EXCHANGE": "transactions_time_filtered"
      }
    },
    "amount_filter": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transactions_time_filtered",
        "INPUT_QUEUE": "transactions_time_filtered_amount",
        "OUTPUT_QUEUE": "gateway_results"
      }
    },
    "tpv": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transactions_time_filtered",
        "INPUT_QUEUE": "transactions_time_filtered_tpv",
        "OUTPUT_QUEUE": "tpv_partial"
      }
    },
    "tpv_sharding_router": {
      "environment": {
        "INPUT_EXCHANGE": "transactions_time_filtered",
        "INPUT_QUEUE": "transactions_time_filtered_tpv_sharding_router",
        "OUTPUT_EXCHANGE": "transactions_time_filtered_tpv_sharded"
      }
    },
    "tpv_sharded": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transactions_time_filtered_tpv_sharded",
        "INPUT_QUEUE": "transactions_time_filtered_tpv_shard",
        "OUTPUT_QUEUE": "tpv_partial"
      }
    },
    "items_top": {
      "count": 2,
      "environment": {
        "INPUT_QUEUE": "transaction_items_year_filtered",
        "OUTPUT_QUEUE": "top_items_partial"
      }
    },
    "items_sharding_router": {
      "environment": {
        "INPUT_QUEUE": "transaction_items_year_filtered",
        "OUTPUT_EXCHANGE": "transaction_items_year_filtered_sharded"
      }
    },
    "items_sharded": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transaction_items_year_filtered_sharded",
        "INPUT_QUEUE": "transaction_items_year_filtered_shard",
        "OUTPUT_QUEUE": "top_items_partial"
      }
    },
    "top_clients_sharding_router": {
      "environment": {
        "INPUT_EXCHANGE": "transactions_year_filtered",
        "INPUT_QUEUE": "transactions_year_filtered_sharding_router",
        "OUTPUT_EXCHANGE": "transactions_year_filtered_sharded"
      }
    },
    "top_clients": {
      "count": 2,
      "environment": {
        "INPUT_EXCHANGE": "transactions_year_filtered_sharded",
        "INPUT_QUEUE": "transactions_year_filtered_shard",
        "OUTPUT_QUEUE": "top_clients_partial"
      }
    },
    "items_aggregator": {
      "environment": {
        "INPUT_QUEUE": "top_items_partial",
        "OUTPUT_QUEUE": "gateway_results"
      }
    },
    "tpv_aggregator": {
      "environment": {
        "INPUT_QUEUE": "tpv_partial",
        "OUTPUT_QUEUE": "gateway_results"
      }
    },
    "top_clients_birthdays": {
      "environment": {
        "INPUT_QUEUE": "top_clients_partial",
        "OUTPUT_QUEUE": "gateway_results"
      }
    }
  }
}
